{% extends '@components/layout.twig' %}
{% block content %}
    <div class="container mx-auto p-4 rounded-md bg-slate-800">
        <div>
            <a href="{{ route('movies.index') }}"
                class="text-gray-400 hover:text-gray-300">
                Nazad
            </a>
        </div>
        <div class="flex gap-6 justify-center">
            {# Image #}
            <div class="h-full">
                <label for="image" class="cursor-pointer">
                    <img src="{{ asset('/images/' ~ movie.image_url) }}"
                        alt="Movie image"
                        class="w-72 h-96 object-cover rounded-md mt-4" />
                </label>
            </div>
            <div class="w-full sm:max-w-md">
                {# Title #}
                <div class="mt-4">
                    <p class="text-2xl font-bold text-center">
                        {{ movie.title }}
                    </p>
                </div>
                {# Release Date #}
                <div class="mt-4">
                    <p>
                        <span class="text-gray-400">Datum izlaska:</span>
                        {{ movie.release_date|date('d.m.Y') }}
                    </p>
                </div>
                {# Runtime #}
                <div class="mt-4">
                    <p>
                        <span class="text-gray-400">Trajanje:</span>
                        {{ movie.runtime }} min
                    </p>
                </div>
                {# Description #}
                <div class="mt-4">
                    <p class="text-gray-400">
                        Opis
                    </p>
                    <p class="text-justify">
                        {{ movie.description }}
                    </p>
                </div>
                {# Genres #}
                <div class="mt-4">
                    <p class="text-gray-400">
                        Žanrovi
                    </p>
                    <div class="flex flex-wrap gap-2">
                        {% for genre in movie.genres %}
                            <span class="bg-gray-900 text-white rounded-md px-2 py-1">
                                {{ genre.name }}
                            </span>
                        {% endfor %}
                    </div>
                </div>
                {# Actors #}
                <div class="mt-4">
                    <p class="text-gray-400">
                        Glumci
                    </p>
                    <div class="flex flex-wrap gap-2">
                        {% for actor in movie.actors %}
                            <span class="bg-gray-900 text-white rounded-md px-2 py-1">
                                {{ actor.name }}
                            </span>
                        {% endfor %}
                    </div>
                </div>
                {# Directors #}
                <div class="mt-4">
                    <p class="text-gray-400">
                        Režiseri
                    </p>
                    <div class="flex flex-wrap gap-2">
                        {% for director in movie.directors %}
                            <span class="bg-gray-900 text-white rounded-md px-2 py-1">
                                {{ director.name }}
                            </span>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        {# Screenings #}
        <div>
            <p class="text-2xl font-bold text-center mt-12 mb-4">
                Projekcije
            </p>
            <div class="flex flex-wrap gap-4 justify-center">
                {% set screeningsByDate = movie.screeningsByDate() %}
                {% if (screeningsByDate|length) == 0 %}
                    <p class="text-gray-400 text-center mt-4">
                        Trenutno nema projekcija za ovaj film.
                    </p>
                {% else %}
                    {% for date, screenings in screeningsByDate %}
                        <div class="w-full flex bg-gray-900 rounded-md p-4 gap-4">
                            <div class="flex flex-col justify-center w-36">
                                <p class="">
                                    {{ date|date('d.m.') }}
                                </p>
                                <p class="text-gray-400">
                                    {{
                                        date
                                            |date('w')
                                            |day_name
                                            |upper
                                            |slice(0, 3)
                                    }}
                                </p>
                            </div>
                            <div class="flex gap-6">
                                {% for screening in screenings %}
                                    <a href="{{
                                        route(
                                            'tickets.create',
                                            screening.id
                                        )
                                        }}"
                                        class="bg-gray-800 rounded-md p-2 hover:bg-blue-800">
                                        <p class="text-center">
                                            {{ screening.time|date('H:i') }}
                                        </p>
                                        <p class="text-center text-gray-400">
                                            {{ screening.hall.name }} ({{
                                                screening.type
                                            }})
                                        </p>
                                        <p class="text-center text-gray-400">
                                            {{ screening.price }} RSD
                                        </p>
                                    </a>
                                {% endfor %}
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>
    </div>
{% endblock %}
